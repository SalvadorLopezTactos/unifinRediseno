{{!--
/*
 * Your installation or use of this SugarCRM file is subject to the applicable
 * terms available at
 * http://support.sugarcrm.com/Resources/Master_Subscription_Agreements/.
 * If you do not agree to all of the applicable terms or do not have the
 * authority to bind the entity as an authorized representative, then do not
 * install or use this SugarCRM file.
 *
 * Copyright (C) SugarCRM Inc. All rights reserved.
 */
--}}
{{#if collection.length}}
    {{#each meta.panels}}
        <div class="create-subpanel flex-list-view-content h-full overflow-auto">
            <table class="table table-striped dataTable overflow-auto{{#has "ReorderableColumns" ../plugins}} reorderable-columns{{/has}}{{#if ../isSearchAndSelectAction}} search-and-select{{/if}}">
                <thead class="table-header-group">
                    <tr class="table-row">
                        {{#each ../leftColumns}}
                            <th{{#if name}} data-fieldname="{{name}}"{{/if}}>
                                <span>
                                    {{field ../../this template="list-header"}}
                                </span>
                            </th>
                        {{/each}}
                        {{#each ../_fields.visible}}
                            <th{{#if name}} data-fieldname="{{name}}"{{/if}} data-orderby="{{orderBy}}" class="h-[42px] relative {{#if widthClass}}{{widthClass}}{{/if}}">
                                {{#has "ReorderableColumns" ../../plugins}}
                                    {{! Insert a <div> around all the inner element of the column.
                                        This is a fix for firefox because the <th> does not support
                                        a relative positioning.}}
                                    <div>
                                        <div class="th-droppable-placeholder" data-droppableindex="{{@index}}"></div>
                                        {{! Insert a <div> around the <span> containing the field label.
                                            That <div> is the draggable element.
                                            This is a fix for firefox because dragging a <th> is not
                                            supported.}}
                                    <div{{#has "ReorderableColumns" ../../../plugins}} data-draggable="true"{{/has}}>
                                {{/has}}
                                <span>
                                    {{str this.label ../../module}}
                                </span>
                                {{#has "ReorderableColumns" ../../plugins}}
                                    </div>
                                        {{#if @last}}
                                            <div class="th-droppable-placeholder th-droppable-placeholder-last" data-droppableindex="{{../../../../_fields.visible.length}}"></div>
                                        {{/if}}
                                    </div>
                                {{/has}}
                            </th>
                        {{/each}}
                        {{#each ../rightColumns}}
                            {{#if isColumnDropdown}}
                                <th class="box-border !border-l-0 h-[42px] nosort morecol stick-right">
                                    <div class="absolute border-l border-[--border-color] dropdown focus-within:z-30 right-0 z-10">
                                        <button class="btn btn-invisible" data-bs-toggle="dropdown"
                                                data-action="fields-toggle" track="click:morecol" aria-expanded="false"
                                                aria-label="{{str 'LBL_COLUMNS'}}" aria-haspopup="true"
                                        >
                                            <i class="sicon sicon-kebab"></i>
                                            {{tooltipTemplate (str 'LBL_COLUMNS') 'bottom'}}
                                        </button>
                                        <ul class="dropdown-menu border-0 dark:border border-[--dropdown-border-widget] rounded-md shadow-xl left">
                                            {{#each ../../../_fields.all}}
                                                <li>
                                                    <button class="{{#if selected}}active{{/if}}" data-field-toggle="{{name}}" track="click:{{name}}">
                                                        {{#if selected}}<i class="sicon sicon-check"></i> {{/if}}{{str label ../../../../module}}
                                                    </button>
                                                </li>
                                            {{/each}}
                                        </ul>
                                    </div>
                                </th>
                            {{else}}
                                <th class="h-[42px]" {{#if name}} data-fieldname="{{name}}"{{/if}}>
                                    <span>
                                        {{field ../../../this template="list-header"}}
                                    </span>
                                </th>
                            {{/if}}
                        {{/each}}
                    </tr>
                    <tr class="table-row">
                        <th data-target="alert-container" class="alert alert-warning hide"{{#if ../this.colSpan}} colspan="{{../../this.colSpan}}"{{/if}}>
                            <div data-target="alert">
                            </div>
                        </th>
                    </tr>
                </thead>
                <tbody class="table-row-group">
                {{#each ../collection.models}}
                    <tr name="{{module}}_{{attributes.id}}" class="single bg-[--dropdown-link-background-hover] table-row">
                        {{#each ../../leftColumns}}
                            <td class="table-cell">
                                {{field ../../../this model=../this template=../../../this.viewName}}
                            </td>
                        {{/each}}
                        {{#each ../../_fields.visible}}
                            <td class="table-cell {{#if align}}{{align}}{{/if}}" data-type="{{type}}">
                                {{field ../../../this model=../this template=../../../this.viewName}}
                            </td>
                        {{/each}}
                        {{#each ../../rightColumns}}
                            <td class="bg-[--dropdown-link-background-hover] right-0 sticky sticky-right table-cell z-10">
                                {{field ../../../this model=../this template=../../../this.viewName}}
                            </td>
                        {{/each}}
                    </tr>
                {{/each}}
                </tbody>
            </table>
        </div>
        {{#if ../collection.dataFetched}}
            {{#unless ../../collection.length}}
                <div class="block-footer">
                    {{str "LBL_NO_DATA_AVAILABLE"}}
                </div>
            {{/unless}}
        {{/if}}
    {{/each}}
{{else}}
    <button type="button" class="btn btn-link btn-invisible" data-action="addRow">
        <i class="sicon sicon-plus"></i>
        <span class="pl-1">
            {{getModuleName module}}
        </span>
    </button>
{{/if}}
